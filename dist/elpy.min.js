var Elpy;(()=>{var t={556:(t,e,i)=>{const s=i(967);t.exports=class{constructor(t,e,i,s,h,o={}){this._name=t,this._x=e,this._y=i,this._width=s,this._height=h,this._events={},this._collision={},this._direction=null,this._distance=null,this._isFlying=!1,this._isJumping=!1,this._isFalling=!1,this._state=null,this._ghost=!1,this._animate=!1,this._track={x:0,y:0},this._offset={x:0,y:0,object:null,engine:{x:0,y:0},rotate:{x:0,y:0}},this._timers={fly:null},this._jump={acceleration:0,multiplier:0,docking:!1},this._degrees=0,this._speeds={fly:null},this._options={obstacle:"boolean"!=typeof o.obstacle||o.obstacle,activity:"boolean"==typeof o.activity&&o.activity,main:"boolean"==typeof o.main&&o.main,pushing:"boolean"==typeof o.pushing&&o.pushing,disabledEvents:"boolean"==typeof o.disabledEvents&&o.disabledEvents,type:o.type||null,custom:o.custom||null,color:o.color||"black",image:{src:("object"==typeof o.image&&null!==o.image?o.image.src:o.image)||null,repeat:("object"==typeof o.image&&null!==o.image?o.image.repeat:null)||null,rendering:!1,cached:null},images:{list:o.images||null,rendering:!1,cached:{}},offset:{x:"object"==typeof o.offset&&null!==o.offset&&void 0!==o.offset.x&&o.offset.x,y:"object"==typeof o.offset&&null!==o.offset&&void 0!==o.offset.y&&o.offset.y}},this._exist=!0,this._MAX_ACCELERATION=10,this._init()}run(t=1,e=1){let i,s;1===t&&(i=this._x+Math.cos(t*(this._degrees+90)*Math.PI/180)*e,s=this._y+Math.sin(t*(this._degrees+90)*Math.PI/180)*e),-1===t&&(i=this._x+Math.sin(t*(this._degrees-180)*Math.PI/180)*e,s=this._y+Math.cos(t*(this._degrees-180)*Math.PI/180)*e),this.move(i,s)}move(t,e){if(!this.checkObjectInViewport())return!1;this._track.x=this._x,this._track.y=this._y;for(const i in this._collision){const s=this._collision[i];if(this!==s&&this.isExist&&s.isExist&&!s.ghost&&t+this._width>s.x&&t<s.x+s.width&&e+this._height>s.y&&e<s.y+s.height){const i=this._getCollisionSide(t,e,s);if(this._dispatchEvent("collision",s,i),s.options.obstacle)return!1}}this._options.offset.x&&t>this._track.x&&(this._offset.x+=Math.abs(this._track.x-t)),this._options.offset.x&&t<this._track.x&&(this._offset.x-=Math.abs(this._track.x-t)),this._options.offset.y&&e>this._track.y&&(this._offset.y+=Math.abs(this._track.y-e)),this._options.offset.y&&e<this._track.y&&(this._offset.y-=Math.abs(this._track.y-e)),this._x=t,this._y=e,this._dispatchEvent("move")}fly(t,e,i=0,h=1){if(0===e)return this._isFlying=!1,this._resetTimers(),!1;this._isFlying&&(this._isFlying=!1,this._resetTimers());const o={start:{x:this._x,y:this._y}},n=new s;this._speeds.fly=e,this._timers.fly=setInterval((()=>{if(this.track.x===this._x&&this.track.y===this._y?this._isFlying=!1:this._isFlying=!0,this._isJumping||this._isFalling)return;if(i>0&&n.distance(o.start.x,o.start.y,this._x,this._y)>i)return this._isFlying=!1,void this.destroy();let e=this._x+parseFloat(Math.cos(t*Math.PI/180).toFixed(10))*h,s=this._y+parseFloat(Math.sin(t*Math.PI/180).toFixed(10))*h;this.move(e,s)}),this._speeds.fly)}jump(t,e=.1){return 0===t?(this._isJumping=!1,this._isFalling=!1,!1):!this._isJumping&&!this._isFlying&&(this._isJumping=!0,this._jump.acceleration=this._getMaxJumpAccelerationValue(t,e),this._jump.multiplier=e,this._jump.docking=!1,void requestAnimationFrame(this._bounce.bind(this)))}fall(t=.1){this._isFalling=!0,this._jump.acceleration=0,this._jump.multiplier=t,this._jump.docking=!1,requestAnimationFrame(this._bounce.bind(this))}push(t,e,i){switch(this._direction=e,this._distance=i,this._direction){case"up":this.move(this.x,this.y-this._distance),t.y!==this.y+this.height&&t.move(t.x,t.y-this._distance);break;case"down":this.move(this.x,this.y+this._distance),t.y+t.height!==this.y&&t.move(t.x,t.y+this._distance);break;case"right":this.move(this.x+this._distance,this.y),t.x+t.width!==this.x&&t.move(t.x+this._distance,t.y);break;case"left":this.move(this.x-this._distance,this.y),t.x!==this.x+this.width&&t.move(t.x-this._distance,t.y)}}rotate(t,e,i){this._offset.rotate.x=e||0,this._offset.rotate.y=i||0,this._degrees=t,this._dispatchEvent("rotate")}destroy(){this._resetTimers(),delete this._collision[this._name],this._exist=!1,this._dispatchEvent("destroy")}collision(t){Array.isArray(t)?t.forEach((t=>{t.isExist&&(this._collision[t.name]=t)})):t.isExist&&(this._collision[t.name]=t)}obstacles(){return Object.values(this._collision)}on(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)}addOffsetObject(t,e,i){this._offset.object=t,this._offset.engine.x=e,this._offset.engine.y=i}checkObjectInViewport(){return!this._checkObjectNotActivity||!this._checkObjectInViewportX&&!this._checkObjectInViewportY}get name(){return this._name}get options(){return this._options}get track(){return this._track}get offset(){return this._offset}get isPushing(){return this._options.pushing}get isFlying(){return this._isFlying}get isFalling(){return this._isFalling}get isExist(){return this._exist}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get width(){return this._width}set width(t){return this._width=t}get height(){return this._height}set height(t){return this._height=t}get state(){return this._state}set state(t){this._state=t,this._dispatchEvent("state")}get animate(){return this._animate}set animate(t){t&&Array.isArray(this.options.images.list)&&this.options.images.list.length>1&&requestAnimationFrame(this._animation.bind(this)),this._animate=t}get ghost(){return this._ghost}set ghost(t){this._ghost=t}get degrees(){return this._degrees}get _checkObjectInViewportX(){return this._x>this._offset.object.x+this._offset.engine.x+2*this._width||this._x<this._offset.object.x-this._offset.engine.x-2*this._width}get _checkObjectInViewportY(){return this._y>this._offset.object.y+this._offset.engine.y+2*this._height||this._y<this._offset.object.y-this._offset.engine.y-2*this._height}get _checkObjectNotActivity(){return!this._options.activity&&this._offset.object}_dispatchEvent(t,...e){this._events[t]&&Array.isArray(this._events[t])&&this._events[t].length>0&&this._events[t].forEach((t=>{t(...e)}))}_animation(){this._animate&&(this._dispatchEvent("state"),requestAnimationFrame(this._animation.bind(this)))}_bounce(){this._isFalling?this._landing():this._takeoff(),(this._isJumping||this._isFalling)&&requestAnimationFrame(this._bounce.bind(this))}_takeoff(){this._jump.acceleration<=0?this._isFalling=!0:(this._jump.acceleration=(Math.floor(10*this._jump.acceleration)-10*this._jump.multiplier)/10,this.move(this._x,this._y-this._jump.acceleration))}_landing(){this._jump.acceleration<=this._MAX_ACCELERATION&&(this._jump.acceleration=(Math.floor(10*this._jump.acceleration)+10*this._jump.multiplier)/10),this._jump.docking?this.move(this._x,this._y+this._jump.multiplier):!1===this.move(this._x,this._y+this._jump.acceleration)&&(this._jump.docking=!0)}_getCollisionSide(t,e,i){let s=null;return t+this._width>i.x&&t<i.x+i.width&&(this._y+this._height<=i.y||this._y>=i.y+i.height)&&(s=i.y-(e+this._height)>e-(i.y+i.height)?"top":"bottom"),e+this._height>i.y&&e<i.y+i.height&&(this._x+this._width<=i.x||this._x>=i.x+i.width)&&(s=i.x-(t+this._width)>t-(i.x+i.width)?"left":"right"),s}_getMaxJumpAccelerationValue(t,e){let i=0,s=0;for(;i<=t;)i+=s,s=(Math.floor(10*s)+10*e)/10;return s}_resetTimers(){clearInterval(this._timers.fly)}_onCollisionPush(t){t.isPushing&&t.push(this,this._direction,this._distance)}_onCollisionSide(t,e){"top"===e&&this._y+this._height===t.y&&(this._isJumping=!1,this._isFalling=!1),"bottom"===e&&(this._y>t.y+t.height?(this._jump.acceleration=(Math.floor(10*this._jump.acceleration)-10*this._jump.multiplier)/10,this.move(this._x,this._y-this._jump.acceleration)):(this._jump.acceleration=0,this._isJumping&&(this._isFalling=!1)))}_init(){this.on("collision",this._onCollisionPush.bind(this)),this.on("collision",this._onCollisionSide.bind(this))}}},967:t=>{t.exports=class{constructor(t,e){this._x=t,this._y=e}distance(t,e,i,s){return Math.sqrt((i-t)**2+(s-e)**2)}}},138:(t,e,i)=>{const s=i(556);t.exports=class{constructor(t,e,i,s={}){this._link=t,this._width=e||window.innerWidth,this._height=i||window.innerHeight,this._preload="boolean"!=typeof s.preload||s.preload,this._field=null,this._ctx=null,this._keys=[],this._storage={images:[]},this._objects={},this._offset={object:null,x:0,y:0},this._init()}create(t,e,i,h,o,n={}){return this._objects[t]=new s(t,e,i,h,o,n),this._objects[t].options.disabledEvents||(this._objects[t].on("move",this._onMoveObject.bind(this)),this._objects[t].on("state",this._onChangeState.bind(this)),this._objects[t].on("rotate",this._onRotateObject.bind(this)),this._objects[t].on("destroy",this._onDestroyObject.bind(this,t))),"boolean"==typeof n.main&&n.main&&this._addOffsetObject(this._objects[t]),this._objects[t]}add(t){Array.isArray(t)?t.forEach((t=>{this._addObjectImages(t),this._render()})):(this._addObjectImages(t),this._render())}key(t){document.addEventListener("keydown",this._onMultiKeydown.bind(this)),document.addEventListener("keyup",this._onMultiKeyup.bind(this)),requestAnimationFrame(this._streamKeys.bind(this,t))}keydown(t){document.addEventListener("keydown",(e=>{t(e.code)}))}keyup(t){document.addEventListener("keyup",(e=>{t(e.code)}))}mousemove(t){this._field.addEventListener("mousemove",(e=>{t(e.x-this._field.offsetLeft,e.y-this._field.offsetTop)}))}click(t){this._field.addEventListener("click",(e=>{t(e.x-this._field.offsetLeft,e.y-this._field.offsetTop)}))}tick(t){!1!==t()&&requestAnimationFrame(this.tick.bind(this,t))}nextTick(t){requestAnimationFrame(t)}async load(){this._imagesIsLoading?(await this._render(),requestAnimationFrame(this.load.bind(this)),this._addOffsetObjects()):(this._preload=!1,await this._render())}get width(){return this._width}get height(){return this._height}get offset(){return this._offset}get objects(){return this._objects}get _imagesIsLoaded(){return!this._preload||this._storage.images.filter((t=>t.loaded)).length===this._storage.images.length}get _imagesIsLoading(){return!!this._preload&&this._storage.images.filter((t=>t.loaded)).length!==this._storage.images.length}_addOffsetObject(t){this._offset.object=t,this._offset.x=t.x,this._offset.y=t.y}_addOffsetObjects(){for(const t in this._objects)this._objects[t].addOffsetObject(this._offset.object,this._offset.x,this._offset.y)}_onMultiKeydown(t){this._keys.includes(t.code)||this._keys.push(t.code)}_onMultiKeyup(t){const e=this._keys.indexOf(t.code);-1!==e&&this._keys.splice(e,1)}_addObjectImages(t){const e=t.options.images.list;t.options.image.src&&this._addObjectImageToStorage(t),e&&this._addObjectImagesToStorage(t)}_addObjectImageToStorage(t){const e=`${t.name}:${t.options.image.src}`;this._storage.images.find((t=>t.id===e))||this._storage.images.push({id:e,loaded:!1})}_addObjectImagesToStorage(t){t.options.images.list.forEach((e=>{e.paths.forEach((i=>{const s=`${t.name}:${e.state}:${i}`;this._storage.images.find((t=>t.id===s))||this._storage.images.push({id:s,loaded:!1})}))}))}_loadImage(t,e,i){return new Promise((s=>{const h=new Image;h.src=t,h.addEventListener("load",(()=>{if(i){const s=`${e.name}:${i}:${t}`;this._storage.images.find((t=>t.id===s)).loaded=!0}else{const i=`${e.name}:${t}`;this._storage.images.find((t=>t.id===i)).loaded=!0}s(h)}))}))}_loadImages(t,e){return new Promise((async i=>{const s={};for(let h=0;h<t.length;h++){const o=t[h];s[o.state]||(s[o.state]=this._getImageParams(o));for(let n=0;n<o.paths.length;n++){const a=o.paths[n];s[o.state].list[n]=await this._loadImage(a,e,o.state),h===t.length-1&&n===o.paths.length-1&&i(s)}}}))}_getImageParams(t){return{list:[],time:t.time||0,currentImage:null,lastRenderTime:0}}async _render(){this._preload||this._ctx.clearRect(0,0,this._width,this._height);for(const t in this._objects){const e=this._objects[t],i=e.options.images.list,s=e.options.image.src;s&&await this._renderImage(e),i&&await this._renderImages(e),s||i||!this._imagesIsLoaded||this._renderShape(e)}this._preload&&this._showLoadingScreen()}async _renderImage(t){if(!t.isExist||t.options.image.rendering)return;await this._renderingImage(t);const e={x:0,y:0};if(this._offset.object?(e.x=this._offset.object.offset.x,e.y=this._offset.object.offset.y):(e.x=this._offset.x,e.y=this._offset.y),this._offset.object&&!this._offset.object.options.offset.x&&(e.x=0),this._offset.object&&!this._offset.object.options.offset.y&&(e.y=0),t.options.image.repeat)return void this._drawRepeatImage(t,e);const i=t.x-e.x+t.width/2,s=t.y-e.y+t.height/2,h=t.degrees*Math.PI/180;t.x>e.x+this._width||t.x+t.width<e.x||t.y>e.y+this._height||t.y+t.height<e.y||(this._ctx.save(),this._ctx.translate(i-t.offset.rotate.x,s-t.offset.rotate.y),this._ctx.rotate(h),this._ctx.translate(-i+t.offset.rotate.x,-s+t.offset.rotate.y),this._ctx.drawImage(t.options.image.cached,t.x-e.x,t.y-e.y,t.width,t.height),this._ctx.restore())}async _renderImages(t){if(!t.isExist||t.options.images.rendering)return;await this._renderingImages(t),t.state||(t.state=this._getFirstState(t.options.images.cached));const e=t.options.images.cached[t.state];if(this._calculateRenderTime(e),this._imagesIsLoading)return;const i={x:0,y:0};this._offset.object?(i.x=this._offset.object.offset.x,i.y=this._offset.object.offset.y):(i.x=this._offset.x,i.y=this._offset.y),this._offset.object&&!this._offset.object.options.offset.x&&(i.x=0),this._offset.object&&!this._offset.object.options.offset.y&&(i.y=0);const s=t.x-i.x+t.width/2,h=t.y-i.y+t.height/2,o=t.degrees*Math.PI/180;if(!this._offset.object)return this._ctx.save(),this._ctx.translate(s-t.offset.rotate.x,h-t.offset.rotate.y),this._ctx.rotate(o),this._ctx.translate(-s+t.offset.rotate.x,-h+t.offset.rotate.y),this._ctx.drawImage(e.currentImage,t.x,t.y,t.width,t.height),void this._ctx.restore();if(this._ctx.save(),this._ctx.translate(s-t.offset.rotate.x,h-t.offset.rotate.y),this._ctx.rotate(o),this._ctx.translate(-s+t.offset.rotate.x,-h+t.offset.rotate.y),t===this._offset.object){let i,s;i=this._offset.object.options.offset.x?this._offset.x:t.x,s=this._offset.object.options.offset.y?this._offset.y:t.y,this._ctx.drawImage(e.currentImage,i,s,t.width,t.height)}else this._ctx.drawImage(e.currentImage,t.x-i.x,t.y-i.y,t.width,t.height);this._ctx.restore()}async _renderingImage(t){t.options.image.rendering=!0,t.options.image.cached||(t.options.image.cached=await this._loadImage(t.options.image.src,t)),t.options.image.rendering=!1}async _renderingImages(t){t.options.images.rendering=!0,this._isEmpty(t.options.images.cached)&&(t.options.images.cached=await this._loadImages(t.options.images.list,t)),t.options.images.rendering=!1}_renderShape(t){const e={x:0,y:0};this._offset.object?(e.x=this._offset.object.offset.x,e.y=this._offset.object.offset.y):(e.x=this._offset.x,e.y=this._offset.y),this._offset.object&&!this._offset.object.options.offset.x&&(e.x=0),this._offset.object&&!this._offset.object.options.offset.y&&(e.y=0);const i=t.x-e.x+t.width/2,s=t.y-e.y+t.height/2,h=t.degrees*Math.PI/180;this._ctx.save(),this._ctx.translate(i-t.offset.rotate.x,s-t.offset.rotate.y),this._ctx.rotate(h),this._ctx.translate(-i+t.offset.rotate.x,-s+t.offset.rotate.y),this._ctx.fillStyle=t.options.color,this._ctx.fillRect(t.x-e.x,t.y-e.y,t.width,t.height),this._ctx.restore()}_getFirstState(t){return Object.keys(t)[0]}_calculateRenderTime(t){if(performance.now()>t.lastRenderTime+t.time){let e=t.list.indexOf(t.currentImage);e+1>t.list.length-1||-1===e?e=0:e+=1,t.lastRenderTime=performance.now(),t.currentImage=t.list[e]}t.currentImage||(t.currentImage=t.list[0])}_streamKeys(t){this._keys.forEach((e=>{t(e)})),requestAnimationFrame(this._streamKeys.bind(this,t))}_onMoveObject(){this._render()}_onChangeState(){this._render()}_onRotateObject(){this._render()}_onDestroyObject(t){delete this._objects[t],this._render()}_drawRepeatImage(t,e){const i=this._ctx.createPattern(t.options.image.cached,"repeat");this._ctx.fillStyle=i,this._ctx.save(),this._ctx.translate(-e.x,-e.y),this._ctx.fillRect(t.x,t.y,t.width,t.height),this._ctx.restore()}_showLoadingScreen(){const t=this._width/2-this._width/2/2,e=this._height/2-this._height/100*10/2,i=this._width/2,s=this._height/100*10,h=this._storage.images.length,o=this._storage.images.filter((t=>t.loaded)).length;this._ctx.fillStyle="black",this._ctx.fillRect(0,0,this._width,this._height),this._ctx.fillStyle="white",this._ctx.fillRect(t,e,i,s),this._ctx.fillStyle="black",this._ctx.fillRect(t+5,e+6,i-10,s-12),this._ctx.fillStyle="white",this._ctx.fillRect(t+4,e+5,(i-8)/h*o,s-10)}_showBlackScreen(){this._ctx.fillStyle="black",this._ctx.fillRect(0,0,this._width,this._height)}_isEmpty(t){return 0===Object.values(t).length}_setFavIcon(){const t=document.getElementsByTagName("head")[0],e=document.createElement("link");e.rel="shortcut icon",e.href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAk1JREFUOE9jZKAQMJKqv6c4UqSkd/kbmD64AY9XhXLeu/Yl8s7xR17MfxifsrOy9EfuuPAApDDGQNF1yYX7u/uyQlXef/nC27xo+3kMA0ACfaGWnIzPn5s//cO0SICFRVyTj3OxtJhY5/xL97vkuFmznojIlHx//7t6wYEDP7AaABOsidFx+Pj+5543z78zR0mJ/z337f89ht+/VzwXFHWasWmfDbK3cYZBTbRh249P3yq/fmFgkGXmYuD8+ffvw59/jk04dc2egYHhP14XgCRzcz3ZPz58Z/Xl298yM30Tj1fXbjA8fHif4R8Hm9b6c7ev4zWgsSTO/8fXb7P+/P0v9vcvI4OUiDjDh9c/GO69ecJw5e5dv0tX72zGaUB1dog/CwvL2h8/fjDzcPEyvP30leHPr38MzAwsDPdfvv5879lbpytXrpzBakBDQwPTx8dnbv7981eFk52T4d///wyvPn1jePzsPcPb958e/mP853H58q0bOAOxIjPYhYHh3+4nz94x/GX4x8DLxcPw+cd/hkfPXzG8+/i16/r1m+XoCQ8lFlKj/PL//P4x4dGzNwy8vFwMChJyDNcePGZ49/kLAxsLk/uxk2d34TUgLtBLjZuH+8b563dOMzH85VWQlhP6//+fOBcnG8PDZ2899hw+vBOvAVkp4ZpCbNzXrt178Pf20+chFrpa8oz/GSd8/f6d4frDh8fPnb9ijZwGQIahJyRGTzd7j3sPHzv8+PFjo5ayxstP3941vHzz4drPfz93P773/CwhA0jNnAwAsYwMINM2tAQAAAAASUVORK5CYII=",t.appendChild(e)}_setDefaultStyle(){document.body.style.margin=0}_setFieldStyle(){"string"==typeof this._link&&(this._field=document.querySelector(this._link)),this._link instanceof HTMLCanvasElement&&(this._field=this._link),this._field.width=this._width,this._field.height=this._height,this._field.style.display="block",this._ctx=this._field.getContext("2d")}_init(){this._setFavIcon(),this._setDefaultStyle(),this._setFieldStyle()}}}},e={},i=function i(s){var h=e[s];if(void 0!==h)return h.exports;var o=e[s]={exports:{}};return t[s](o,o.exports,i),o.exports}(138);Elpy=i})();